// ### CONNECT TO DB ###
// Fine i'll do it myself..
// Couldn't get any npm packages to work with sqlcipher..
import path from 'path';
import 'dotenv/config';
import { execSync } from "child_process";
import { jsonifySelect } from '../JSONutils.js';
// Get paths:
const rootPath = path.resolve('./');
const dbPath = rootPath + process.env.DB_PATH;
const dbPass = process.env.DB_PASS;
// EXECUTES a query.
// RETURNS a string.
function dbQuery(query) {
    try {
        // Executes the query, converts it into a string and gets rid of the empty line and the "ok" generated by the pragma key.
        let arr = execSync(`sqlcipher ${dbPath} -cmd "PRAGMA key=${dbPass}" ".headers ON" "${query}"`).toString().split("\n");
        return arr.splice(1, arr.length - 2).join("\n");
    }
    catch (error) {
        return error.message;
    }
}
// ### TEST HERE ###
const queryTest = `SELECT * FROM User WHERE user_id > 2;`;
const result = dbQuery(queryTest);
console.log(jsonifySelect(result));
//# sourceMappingURL=CONNECTutils.js.map